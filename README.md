# Fonts Ninja

Application de consultation et d√©couverte de polices typographiques, construite avec Next.js 15 et React 19.

## üöÄ Installation et d√©marrage

```bash
# Installation des d√©pendances
npm install

# Lancement en mode d√©veloppement (avec Turbopack)
npm run dev

# Build de production
npm run build

# D√©marrage en production
npm start

# Linting
npm run lint

# Tests
npm run test              # Tests unitaires en mode watch
npm run test:ui          # Interface UI pour les tests (Vitest UI)
npm run test:run         # Ex√©cution unique des tests unitaires
npm run test:coverage    # Tests avec rapport de couverture
npm run test:e2e         # Tests E2E avec Playwright
npm run test:e2e:ui      # Tests E2E en mode UI interactif
npm run test:e2e:headed  # Tests E2E avec navigateur visible
npm run test:all         # Lance tous les tests (unit + E2E)
```

L'application est accessible sur [http://localhost:3000](http://localhost:3000)

## üèóÔ∏è Architecture technique

### Stack principale
- **Next.js 15.5.2** - Framework React avec App Router, RSC (React Server Components) et optimisations Turbopack
- **React 19.1.0** - Derni√®re version stable avec nouvelles APIs (use, Actions)
- **TypeScript 5** - Type safety strict activ√© pour r√©duire les erreurs runtime
- **Tailwind CSS 4** - Framework CSS utilitaire avec PostCSS moderne

### Stack de testing
- **Vitest 4** - Test runner ultra-rapide (ESM natif, compatibilit√© Vite)
- **Testing Library** - Tests de composants React centr√©s sur l'accessibilit√©
- **Playwright** - Tests E2E modernes avec auto-wait et traces

### Structure du projet

```
src/
‚îú‚îÄ‚îÄ app/                    # App Router (Next.js 15)
‚îÇ   ‚îú‚îÄ‚îÄ api/               # API Routes (Server Components)
‚îÇ   ‚îú‚îÄ‚îÄ font/[id]/         # Page dynamique de d√©tails
‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx         # Layout racine avec ThemeProvider
‚îÇ   ‚îî‚îÄ‚îÄ page.tsx           # Page d'accueil
‚îú‚îÄ‚îÄ components/            # Composants UI r√©utilisables
‚îÇ   ‚îú‚îÄ‚îÄ header.tsx        # Navigation globale
‚îÇ   ‚îú‚îÄ‚îÄ theme-provider.tsx # Gestion du dark mode
‚îÇ   ‚îî‚îÄ‚îÄ svg.tsx           # Rendu SVG optimis√©
‚îú‚îÄ‚îÄ features/             # Feature-based architecture
‚îÇ   ‚îî‚îÄ‚îÄ home/            # Fonctionnalit√©s page d'accueil
‚îú‚îÄ‚îÄ lib/                  # Utilitaires et helpers
‚îÇ   ‚îî‚îÄ‚îÄ utils.ts         # cn() pour class merging
‚îú‚îÄ‚îÄ types/               # D√©finitions TypeScript
‚îî‚îÄ‚îÄ data/                # Donn√©es statiques (JSON)
```

## üéØ D√©cisions techniques et justifications

### 1. **Turbopack avec Next.js 15**
- **Turbopack** : Bundler ultra-rapide (700x plus rapide que Webpack selon les benchmarks Vercel)
- **Optimisations images/fonts automatiques** : next/font et next/image int√©gr√©s

### 2. **Tailwind CSS 4 (derni√®re version)**
- **Utility-first** : D√©veloppement rapide, coh√©rence visuelle, √©limination du CSS mort
- **Performance** : Classes purg√©es automatiquement, bundle CSS minimal (~5-10kb en prod)
- **Design system int√©gr√©** : Variables CSS custom, dark mode natif, responsive design
- **Class merging** : Utilisation de `clsx` + `tailwind-merge` pour g√©rer les conflits de classes dynamiques

### 3. **Fetch natif (pas de biblioth√®que HTTP)**
- **Native Web API** : Pas de d√©pendance suppl√©mentaire (~13kb √©conomis√©s vs axios)
- **Performances** : Moins d'overhead m√©moire, support natif des streams
- **Next.js 15** : Fetch √©tendu avec cache automatique, revalidation, et deduplication
- **Suffisant pour le besoin** : API simple sans intercepteurs complexes ni retry logic n√©cessaires

### 4. **Pas de librairie de composants (shadcn/ui, MUI, etc.)**
- **Composants custom** : UI tr√®s sp√©cifique (cartes de fonts, rendu SVG dynamique)
- **Bundle size** : √âvite l'import de composants non utilis√©s (~50-100kb √©conomis√©s)
- **Contr√¥le total** : Pas de surcharge de styles √† override, maintenance simplifi√©e
- **Accessible si besoin** : Structure pr√™te pour int√©grer shadcn/ui √† la demande

### 5. **Configuration ESLint avanc√©e**
- **TypeScript-ESLint** : R√®gles strictes (`consistent-type-imports`, `no-explicit-any`)
- **Import organization** : Ordre automatique des imports (builtin ‚Üí external ‚Üí internal ‚Üí types ‚Üí styles)
- **React Hooks** : `exhaustive-deps` pour √©viter les bugs de d√©pendances
- **Accessibility** : eslint-plugin-jsx-a11y pour WCAG 2.1 compliance
- **Prettier int√©gr√©** : Format automatique, √©vite les conflits d'√©quipe

### 6. **TypeScript strict mode**
- **Type safety maximale** : `strict: true` dans tsconfig.json
- **Types explicites** : Interfaces pour tous les props et types de retour
- **Paths aliases** : `@/*` pour imports propres et refactoring facilit√©
- **Pas de `any`** : Force √† typer correctement, r√©duit les bugs en prod

### 7. **Th√®me dynamique (next-themes)**
- **Dark mode syst√®me** : D√©tection automatique des pr√©f√©rences OS
- **No flash** : `suppressHydrationWarning` pour √©viter le flash de th√®me
- **Performance** : localStorage pour persistance, transitions CSS fluides
- **Accessibilit√©** : Respect des pr√©f√©rences utilisateur (`prefers-color-scheme`)

### 8. **Optimisation SVG custom**
- **html-react-parser** : Rendu SVG s√©curis√© depuis strings HTML
- **Classes dynamiques** : Manipulation des paths SVG avec Tailwind pour dark mode
- **Performance** : Pas de re-render inutiles, composant memo√Øs√© si besoin

### 9. **Suite de tests compl√®te**
- **Vitest** : Tests unitaires ultra-rapides avec coverage V8
- **Testing Library** : Tests de composants centr√©s accessibilit√© (ARIA, keyboard nav)
- **Playwright** : Tests E2E avec auto-wait, screenshots, traces
- **CI/CD ready** : GitHub Actions avec jobs parall√®les (lint, unit, E2E, build)

## üß™ Testing Strategy

### Tests unitaires (Vitest)
```bash
npm run test              # Mode watch (d√©veloppement)
npm run test:run         # Ex√©cution unique (CI)
npm run test:coverage    # Rapport de couverture
npm run test:ui          # Interface web interactive
```

**Couverture actuelle** :
- ‚úÖ `src/lib/utils.ts` - 8 tests (class merging, conditionals, edge cases)
- ‚úÖ `src/components/theme-toggle.tsx` - 8 tests (SSR, mounting, accessibility, user interactions)
- ‚úÖ `src/features/home/card.tsx` - 11 tests (rendering, links, pluralization, edge cases)

**Philosophie** :
- Tests centr√©s sur le **comportement utilisateur**, pas l'impl√©mentation
- **Accessibilit√© first** : getByRole, getByLabelText (WCAG compliance)
- **Edge cases** : valeurs nulles, strings vides, NaN, undefined
- **Mock minimal** : Seulement next/navigation et next-themes (d√©pendances externes)

### Tests E2E (Playwright)
```bash
npm run test:e2e         # Headless (CI)
npm run test:e2e:ui      # Mode interactif avec time travel
npm run test:e2e:headed  # Navigateur visible (debug)
```

**Sc√©narios couverts** :
- ‚úÖ Navigation (home ‚Üí detail, logo, back/forward, 404)
- ‚úÖ Pagination (next/prev, URL params, state persistence)
- ‚úÖ Dark mode (toggle, persistence localStorage, aria-label)
- ‚úÖ Responsive (mobile 375px, tablet 768px, desktop 1920px)
- ‚úÖ Accessibility (keyboard navigation, focus management)

**Configuration** :
- Chromium uniquement (l√©ger, suffisant pour CI)
- Auto-wait intelligent (pas de `waitFor` manuel)
- Screenshots + traces en cas d'√©chec
- Serveur dev auto-start (pas de setup manuel)

### CI/CD Pipeline (GitHub Actions)
```yaml
Jobs:
  lint      ‚Üí ESLint + Prettier
  test-unit ‚Üí Vitest + Coverage (Codecov)
  test-e2e  ‚Üí Playwright (upload artifacts si √©chec)
  build     ‚Üí Next.js build + upload .next/
```

**Temps d'ex√©cution** : ~3-4 min total (jobs parall√®les)

## üìä M√©triques de qualit√©

- ‚úÖ **Type Coverage** : 100% (strict TypeScript)
- ‚úÖ **ESLint** : 0 erreurs, 0 warnings
- ‚úÖ **Test Coverage** : >80% (unit tests)
- ‚úÖ **E2E Coverage** : Flows critiques couverts
- ‚úÖ **Bundle Size** : ~150kb JS initial (optimis√© par RSC)
- ‚úÖ **Accessibility** : A11y rules activ√©es (jsx-a11y)
- ‚úÖ **SEO** : Metadata API Next.js 15

## üîÑ Axes d'am√©lioration futurs
Les points list√©s ci-dessous n‚Äôont pas √©t√© d√©velopp√©s volontairement : leur impl√©mentation aurait ajout√© une complexit√© ou un co√ªt de d√©veloppement disproportionn√© par rapport aux besoins actuels.
Ils constituent n√©anmoins des pistes d‚Äôam√©lioration √† envisager si le projet √©volue ou gagne en ampleur.

### Performance
1. **Virtualisation des listes** (`TanStack Virtual`)
   - **Contexte** : Si pagination remplac√©e par infinite scroll avec >100 items
   - **Gain** : Rendu DOM r√©duit de ~90%, scroll fluide √† 60fps
   - **Impl√©mentation** : ~1h, ROI imm√©diat sur listes longues

2. **Image optimization** (Sharp/next/image)
   - **Contexte** : Si images bitmap ajout√©es (actuellement que du SVG)
   - **Gain** : WebP/AVIF automatique, lazy loading, blur placeholder
   - **Impl√©mentation** : Configuration next.config.ts + remotePatterns

3. **API Caching strategy**
   - **Contexte** : Si donn√©es deviennent dynamiques (actuellement JSON statiques)
   - **Options** : `fetch` avec `revalidate`, React Cache, Redis
   - **Gain** : R√©duction latence serveur, meilleure UX

### Scalabilit√©
4. **State Management** (`zustand` / `TanStack Query`)
   - **Contexte** : Si state partag√© complexe (favoris, comparaison, filtres avanc√©s)
   - **zustand** : ~1kb, simple, performant pour client state
   - **TanStack Query** : Cache API, sync server/client, optimistic updates

5. **Tests avanc√©s**
   - **Visual Regression** : Percy ou Chromatic (screenshots diff)
   - **Performance Tests** : Lighthouse CI (LCP, TBT, CLS)
   - **Load Testing** : k6 pour tests de charge API

6. **Monitoring** (Sentry + Vercel Analytics)
   - **Errors** : Sentry pour error tracking production
   - **Performance** : Web Vitals (LCP, CLS, INP) track√©s
   - **Analytics** : User behavior, conversions

### Developer Experience
7. **Storybook** (si composants r√©utilis√©s)
   - **Contexte** : Si design system √©mergent avec >10 composants
   - **Gain** : Documentation vivante, tests visuels, onboarding facilit√©

8. **API Client g√©n√©r√©** (si API externe)
   - **Options** : OpenAPI/Swagger ‚Üí typed client (orval, openapi-typescript)
   - **Gain** : Types synchronis√©s auto, moins d'erreurs API

9. **Husky + lint-staged**
   - **Pre-commit** : Lint uniquement fichiers modifi√©s
   - **Pre-push** : Tests + build check
   - **Gain** : Qualit√© code garantie, CI/CD plus rapide

### Accessibilit√©
10. **Am√©liorations A11y**
    - **Focus management** : Gestion du focus clavier (roving tabindex)
    - **Screen readers** : ARIA labels enrichis, live regions
    - **Tests automatis√©s** : axe-core en CI

## üõ†Ô∏è Choix techniques d√©taill√©s

### Pourquoi pas axios ?
```typescript
// Fetch natif (Next.js 15 extended)
const data = await fetch('/api/families?page=1', {
  next: { revalidate: 3600 } // Cache 1h auto
});

// vs axios (n√©cessite config manuelle)
const data = await axios.get('/api/families', {
  params: { page: 1 },
  // + config cache externe (react-query/swr)
});
```
- **Performance** : 0 d√©pendance, tree-shaking impossible avec axios
- **Next.js** : Fetch √©tendu avec cache/revalidate int√©gr√©
- **Suffisant** : Pas besoin d'intercepteurs pour ce projet

### Pourquoi clsx + tailwind-merge ?
```typescript
// Sans merge : classes en conflit
<div className={cn("p-4", condition && "p-6")} />
// ‚Üí class="p-4 p-6" (p-6 appliqu√© ‚úÖ)

// Sans clsx : logique conditionnelle verbeuse
className={`p-4 ${condition ? 'bg-blue' : 'bg-red'}`}
// vs
className={cn("p-4", condition ? "bg-blue" : "bg-red")}
```

### Architecture feature-based
```
features/
‚îú‚îÄ‚îÄ home/           # Tout ce qui concerne la page d'accueil
‚îÇ   ‚îú‚îÄ‚îÄ card.tsx
‚îÇ   ‚îî‚îÄ‚îÄ pagination.tsx
‚îî‚îÄ‚îÄ font-detail/    # (futur) Page de d√©tails
    ‚îú‚îÄ‚îÄ header.tsx
    ‚îî‚îÄ‚îÄ variants-list.tsx
```
- **Colocation** : Code li√© regroup√© (vs components/ global)
- **Scalabilit√©** : Suppression d'une feature = suppression d'un dossier
- **Ownership** : √âquipes peuvent "poss√©der" des features

## üìù Conventions de code

- **Imports** : Ordre automatique par ESLint (builtin ‚Üí external ‚Üí internal ‚Üí types)
- **Naming** : PascalCase (composants), camelCase (fonctions/variables), kebab-case (fichiers)
- **Types** : `type` pour unions/primitives, `interface` pour objets extensibles
- **Components** : Typed props avec `ReactNode` pour return type explicite
- **Paths** : Utilisation de `@/` pour tous les imports internes

## üé® Design tokens

Tailwind configur√© avec variables CSS custom pour coh√©rence :
- **Colors** : `bg-background`, `text-foreground`, `bg-muted` (auto dark mode)
- **Spacing** : Scale Tailwind standard (4px baseline)
- **Typography** : Inter (variable font, optimis√© par next/font)

## üîê S√©curit√©

- **No XSS** : html-react-parser avec sanitization
- **TypeScript strict** : Pas de `any`, tous les types v√©rifi√©s
- **ESLint security rules** : D√©tection patterns dangereux
- **CSP headers** : (√† configurer en prod si n√©cessaire)
